<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Secure Portal</title>
 <style>
body {
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#f2f4f7;
  color:#1a1a1a;
}

/* TOPBAR */
.topbar {
  background:#002a5c;
  height:72px;
  display:flex;
  align-items:center;
  justify-content:space-between; /* logo left, user right */
  padding:0 28px;
  width:100%;
  box-sizing:border-box;
  flex-shrink:0;
}

/* LOGO AND USER */
.logo-placeholder {
  width:180px;
  height:34px;
  background:rgba(255,255,255,0.25);
  border-radius:4px;
}

.topbar-user {
  color:#ffffff;
  font-size:13px;
  white-space:nowrap;
}

/* MAIN LOGIN PAGE (unchanged) */
.main {
  max-width:1024px;
  margin:48px auto;
  padding:0 20px;
  display:grid;
  grid-template-columns:1.1fr 0.9fr;
  gap:48px;
}

.hero h1 { font-size:30px;font-weight:300;margin:0 0 16px;color:#002a5c; }
.hero p { font-size:16px;line-height:1.5;color:#4b5563;margin:0; }

.card {
  background:#fff;
  border-radius:6px;
  box-shadow:0 6px 18px rgba(0,0,0,0.1);
  padding:32px;
}

.card h2 { font-size:22px;font-weight:400;margin:0 0 10px; }
.card p { font-size:14px;color:#6b7280;margin:0 0 26px; }

label { display:block;font-size:13px;font-weight:600;margin-bottom:6px;color:#1f2933; }

input {
  width:100%;
  padding:12px 10px;
  border:1px solid #cfd4da;
  border-radius:4px;
  font-size:14px;
  margin-bottom:20px;
}

input:focus {
  outline:none;
  border-color:#003a8f;
  box-shadow:0 0 0 2px rgba(0,58,143,0.15);
}

button {
  width:100%;
  background:#003a8f;
  color:#fff;
  border:none;
  border-radius:4px;
  padding:11px 12px;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
}

button:hover { background:#002e73; }

.links { margin-top:18px; display:flex; justify-content:space-between; font-size:13px; }
.links a { color:#003a8f; text-decoration:none; }

footer { margin:40px auto 20px; text-align:center; font-size:12px; color:#6b7280; }

.hidden { display:none; }

/* DASHBOARD WRAPPER */
.dash-wrapper{
  display:flex;
  min-height:calc(100vh - 72px);
  width:100%;
  overflow-x: hidden; /* prevent page horizontal scroll */
}

/* SIDEBAR */
.sidebar {
  width:240px;
  background:#002a5c;
  color:#fff;
  padding:24px;
}

.sidebar h3 { margin:0 0 18px; font-size:16px; font-weight:600; }
.sidebar a {
  display:block;
  color:#fff;
  text-decoration:none;
  font-size:14px;
  padding:10px 8px;
  border-radius:4px;
  margin-bottom:6px;
}

.sidebar a:hover { background:rgba(255,255,255,0.12); }
.sidebar a.active { background:rgba(255,255,255,0.18); }

/* CONTENT PANELS */
.content {
  flex:1;
  padding:32px;
  background:#f5f7fa;
  min-width:0; /* allows child panels to shrink correctly */
}

/* ---- Base Panel Style ---- */
.panel {
  background: #fff;
  border-radius: 6px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  padding: 24px;
  margin-bottom: 24px;
  width: 100%;
  overflow-x: auto;
  box-sizing: border-box;

  /* Initial state */
  opacity: 0;
  transform: scale(0.975);

  transition:
    opacity 0.85s cubic-bezier(0.22, 0.61, 0.36, 1),
    transform 0.85s cubic-bezier(0.22, 0.61, 0.36, 1);
}

/* ---- Show Panel ---- */
.panel.show {
  opacity: 1;
  transform: scale(1);
}

/* ---- Children of Panels ---- */
.panel > * {
  opacity: 0;
  transform: scale(0.985);

  transition:
    opacity 0.7s cubic-bezier(0.22, 0.61, 0.36, 1),
    transform 0.7s cubic-bezier(0.22, 0.61, 0.36, 1);
}

/* ---- Show Children ---- */
.panel.show > * {
  opacity: 1;
  transform: scale(1);
}

/* ---- Stagger for all panel children (slower & elegant) ---- */
.panel.show > *:nth-child(1)  { transition-delay: 0.15s; }
.panel.show > *:nth-child(2)  { transition-delay: 0.30s; }
.panel.show > *:nth-child(3)  { transition-delay: 0.45s; }
.panel.show > *:nth-child(4)  { transition-delay: 0.60s; }
.panel.show > *:nth-child(5)  { transition-delay: 0.75s; }
.panel.show > *:nth-child(6)  { transition-delay: 0.90s; }
.panel.show > *:nth-child(7)  { transition-delay: 1.05s; }
.panel.show > *:nth-child(8)  { transition-delay: 1.20s; }
.panel.show > *:nth-child(9)  { transition-delay: 1.35s; }
.panel.show > *:nth-child(10) { transition-delay: 1.50s; }

/* ---- Specific Large Panels (Payments, Transactions, Investments) ---- */
#payments,
#transactions,
#investments {
  opacity: 0;
  transform: scale(0.965);

  transition:
    opacity 0.9s cubic-bezier(0.22, 0.61, 0.36, 1),
    transform 0.9s cubic-bezier(0.22, 0.61, 0.36, 1);
}

#payments.show,
#transactions.show,
#investments.show {
  opacity: 1;
  transform: scale(1);
}

/* ---- Children inside large panels ---- */
#payments > *,
#transactions > *,
#investments > * {
  opacity: 0;
  transform: scale(0.985);

  transition:
    opacity 0.75s cubic-bezier(0.22, 0.61, 0.36, 1),
    transform 0.75s cubic-bezier(0.22, 0.61, 0.36, 1);
}

#payments.show > *,
#transactions.show > *,
#investments.show > * {
  opacity: 1;
  transform: scale(1);
}

/* ---- Stagger for large panels ---- */
#payments.show > *:nth-child(1),
#transactions.show > *:nth-child(1),
#investments.show > *:nth-child(1) { transition-delay: 0.18s; }

#payments.show > *:nth-child(2),
#transactions.show > *:nth-child(2),
#investments.show > *:nth-child(2) { transition-delay: 0.36s; }

#payments.show > *:nth-child(3),
#transactions.show > *:nth-child(3),
#investments.show > *:nth-child(3) { transition-delay: 0.54s; }

#payments.show > *:nth-child(4),
#transactions.show > *:nth-child(4),
#investments.show > *:nth-child(4) { transition-delay: 0.72s; }

#payments.show > *:nth-child(5),
#transactions.show > *:nth-child(5),
#investments.show > *:nth-child(5) { transition-delay: 0.90s; }

#payments.show > *:nth-child(6),
#transactions.show > *:nth-child(6),
#investments.show > *:nth-child(6) { transition-delay: 1.08s; }

/* ================= Premium Overview Panel ================= */

/* Overview Panel initial state */
#overview {
  opacity: 0;
  transform: scale(0.97);

  transition:
    opacity 1s cubic-bezier(0.22, 0.61, 0.36, 1),
    transform 1s cubic-bezier(0.22, 0.61, 0.36, 1);
}

/* Overview Panel when shown */
#overview.show {
  opacity: 1;
  transform: scale(1);
}

/* Children inside Overview */
#overview > * {
  opacity: 0;
  transform: scale(0.99);

  transition:
    opacity 0.8s cubic-bezier(0.22, 0.61, 0.36, 1),
    transform 0.8s cubic-bezier(0.22, 0.61, 0.36, 1);
}

/* Show children of Overview */
#overview.show > * {
  opacity: 1;
  transform: scale(1);
}

/* Stagger for Overview children */
#overview.show > *:nth-child(1) { transition-delay: 0.2s; }
#overview.show > *:nth-child(2) { transition-delay: 0.4s; }
#overview.show > *:nth-child(3) { transition-delay: 0.6s; }
#overview.show > *:nth-child(4) { transition-delay: 0.8s; }
#overview.show > *:nth-child(5) { transition-delay: 1.0s; }
#overview.show > *:nth-child(6) { transition-delay: 1.2s; }
#overview.show > *:nth-child(7) { transition-delay: 1.4s; }
#overview.show > *:nth-child(8) { transition-delay: 1.6s; }

/* Utility */
.hidden {
  display: none !important;
}


#investments{
  min-width:300px;       /* make card wider */
  overflow-x:auto;       /* horizontal scroll if content exceeds */
}

#investments table,
#investments canvas{
  max-width:100%;        /* prevent child elements from overflowing */
  display:block;
}

.balance { font-size:26px;font-weight:300;color:#002a5c;margin-bottom:10px; }
.muted { font-size:13px;color:#6b7280; }

.table {
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}

.table th, .table td { padding:10px; border-bottom:1px solid #e5e7eb; text-align:left; }
.table th { font-weight:600; color:#374151; }

/* RESPONSIVE */
@media(max-width:900px){
  .main { grid-template-columns:1fr; gap:32px; }
  .hero h1 { font-size:26px; }
  
  /* DASHBOARD ON MOBILE */
  .dash-wrapper {
    flex-direction:column;
    width:100%;
  }

  .sidebar {
    width:100%;
    display:flex;
    overflow-x:auto;
  }

  .sidebar a { white-space:nowrap; margin-right:8px; }

  /* PANEL SCROLLING FOR TABLES/CHARTS */
  .panel { overflow-x:auto; }
 }
  .content {
  max-width: 960px;
  margin: 0 auto;
  padding: 24px;
   }
   .overview-panel {
  min-height: 260px;
  display: flex;
  flex-direction: column;
   }
   
   #overview {
  min-height: 260px;                 
  display: flex;                     
  flex-direction: column;            
  padding: 32px 24px 24px 24px;      /* extra top padding for breathing space */
  background: #fff;                  
  border-radius: 8px;                /* slightly rounder corners */
  box-shadow: 0 8px 24px rgba(0,0,0,0.08); /* slightly deeper shadow */
  max-width: 340px;                  
  width: 100%;                       
  margin: 16px auto 0 auto;          /* more space from top header */
  border: 1px solid #e5e7eb;        
}

/* Make main content take available vertical space */
#overview .overview-content {
  flex: 1;                            
  display: flex;
  flex-direction: column;             
}

/* Balance styling */
#overview .balance {
  font-size: 26px;
  font-weight: 300;
  color: #002a5c;
  margin-bottom: 10px;
}

#overview .muted {
  font-size: 13px;
  color: #6b7280;
}

/* Button pinned to bottom */
#overview button {
  margin-top: auto;
  padding: 12px 16px;                /* slightly bigger click area */
  border-radius: 6px;                
  font-weight: 600;
  font-size: 15px;
}
   /* Button Hover Effect */
#overview button {
  transition: background 0.2s ease, transform 0.15s ease, box-shadow 0.15s ease;
}

#overview button:hover {
  background: #002e73;           /* slightly darker blue on hover */
  transform: translateY(-2px);   /* tiny lift effect */
  box-shadow: 0 4px 12px rgba(0,0,0,0.12); /* subtle shadow */
}

   /* Hover Lift Effect */
#overview {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

#overview:hover {
  transform: translateY(-4px); /* slightly lifts card */
  box-shadow: 0 12px 32px rgba(0,0,0,0.12); /* deeper shadow on hover */
}

 .flex { 
  display: flex; 
  flex-direction: column; 
 }

 .panel-section {
  margin-bottom: 30px;
}

.panel-section h3 {
  font-size: 16px;
  font-weight: 600;
  color: #002a5c;
  margin-bottom: 12px;
}

.success {
  color: #065f46;
  font-weight: 600;
}

.error {
  color: #b91c1c;
  font-weight: 600;
}
   .settings-section {
  margin-bottom: 12px;
}

.section-toggle {
  width: 100%;
  text-align: left;
  padding: 10px 12px;
  font-weight: 600;
  font-size: 14px;
  background: #f5f7fa;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  cursor: pointer;
}

.section-toggle:hover {
  background: #e5e7eb;
}

.section-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.35s ease, padding 0.35s ease;
  padding: 0 12px;
}

.section-content.open {
  padding: 10px 12px;
  max-height: 500px; /* enough for content */
  }

   /* Section headers (Account Details, Change Password, etc.) */
.section-toggle {
  color: #002a5c; /* Credit Suisse blue */
}

/* Section content text */
.section-content p,
.section-content label,
.section-content li {
  color: #000; /* solid black for readability */
}

/* Success / error messages */
.success {
  color: #065f46; /* green success */
  font-weight: 600;
}
.error {
  color: #b91c1c; /* red error */
  font-weight: 600;
}
   
.dash-wrapper {
  display: flex;
  flex-direction: column;
  min-height: 100vh; /* full viewport height */
}

.dashboard-content {
  flex: 1; /* takes remaining space, pushes footer down */
   }
   
.footer-spacer {
    height: calc(100vh - 100%);
}

#transferBanner {
  transition: opacity 0.35s ease, transform 0.35s ease;
  transform: translateY(-6px);
}

#transferBanner[style*="display: block"] {
  transform: translateY(0);
}
   
button:active {
  transform: translateY(1px);
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);
    }

 @keyframes softPulse {
  0% { opacity: 0.7; }
  50% { opacity: 1; }
  100% { opacity: 0.7; }
}

#loginLoading,
#otpCountdown {
  animation: softPulse 2s ease-in-out infinite;
}
</style>
</head>
<body>
  <div class="topbar">
    <div class="logo-placeholder"></div>
    <div class="topbar-user hidden" id="topbarUser">Welcome, <strong>Gerard</strong> | <a href="#" onclick="logout()">Log out</a></div>
  </div>

  <!-- LOGIN PAGE -->
  <div id="loginPage">
    <div class="main">
      <div class="hero">
        <h1>Welcome to Online Banking</h1>
        <p>Access your accounts and manage your finances securely anytime, anywhere.</p>
      </div>

      <div class="card">
        <h2>Log in</h2>
        <p>Please enter your credentials.</p>

        <form onsubmit="event.preventDefault();login();">
          <label for="user">User ID</label>
          <input id="user" type="text" />

          <label for="pass">Password</label>
          <input id="pass" type="password" />

          <div id="loginLoading" class="muted hidden" style="margin-top:14px; font-size:14px;">
  Fetching your account...
          </div>       

          <button type="submit">Log in</button>

          <div class="links">
            <a href="#">Forgot password?</a>
            <a href="#">Register</a>
          </div>

          <div class="muted" style="margin-top:18px;font-size:12px;line-height:1.4;">
            For your security, please ensure that your browser address bar shows a secure connection.
            Never share your login credentials with anyone.
          </div>

          <div id="loginError" class="muted" style="color:#b91c1c;margin-top:12px;display:none;">Invalid username or password.</div>
        </form>
      </div>
    </div>

    <div class="footer-spacer"></div>
    <footer>
      © 2026 Your Company. All rights reserved.
    </footer>
  </div>

  <!-- SECURE ACCESS -->
  <div id="secureAccess" class="hidden">
  <div class="main">
    <div class="card" style="max-width:420px;margin:0 auto;">
      <h2>Secure Access</h2>

      <p class="muted" style="margin-bottom:12px;">
        Enter the one-time code below to continue.
      </p>

      <div id="otpDisplay"
           style="font-size:18px;
                  font-weight:700;
                  color:#002a5c;
                  letter-spacing:2px;
                  margin-bottom:6px;">
      </div>

      <div id="otpCountdown" class="muted" style="font-size:12px;margin-bottom:14px;">
  Code expires in <strong><span id="otpTimer">60</span></strong> seconds
      </div>
      
      <label>Verification code</label>
      <input type="text" id="otp" placeholder="Enter 6-digit code">

      <button onclick="verifyOTP()">Verify</button>

      <div id="phoneError"
           class="error"
           style="margin-top:12px;display:none;">
        Invalid or expired verification code.
      </div>

      <div class="muted" style="margin-top:14px;font-size:12px;">
        Didn't get it?
        <a href="#" onclick="resendOTP();return false;"
           style="color:#003a8f;text-decoration:none;">
          Request a new code
        </a>
      </div>
    </div>
  </div>
  </div>
      

  <!-- DASHBOARD -->
  <div id="dashboard" class="hidden">
    <div class="dash-wrapper">
  <!-- Sidebar -->
  <div class="sidebar">
    <a href="#" onclick="showSection('overview')">Account overview</a>
    <a href="#" onclick="showSection('payments')">Payments</a>
    <a href="#" onclick="showSection('transactions')">Transactions</a>
    <a href="#" onclick="showSection('investments')">Investments</a>
    <a href="#" onclick="showSection('portfolio')">Portfolio</a>
    <a href="#" onclick="showSection('markets')">Market Services</a>
    <a href="#" onclick="showSection('settings')">Settings</a>
    <a href="#" onclick="logout()">Log out</a>
  </div>

  <!-- Main content + panels -->
  <div class="dashboard-content">
    <!-- Overview -->
    <div id="overview" class="panel overview-panel">
      <h2>Account overview</h2>
      <div class="muted" style="margin-bottom:10px;">Current balance</div>
      <div class="balance" id="balanceDisplay"></div>
      <div style="margin-top:auto;">
        <button onclick="showSection('payments')">Make a Transfer</button>
      </div>
    </div>

    <!-- Payments -->
    <div id="payments" class="panel hidden">
      <h2>Payments</h2>
      <div id="transferMessage" class="muted hidden"
           style="margin-bottom:14px;padding:10px;border-radius:4px;font-size:14px;"></div>

      <div id="transferBanner"
     style="display:none;
            margin-bottom:14px;
            padding:10px 14px;
            border-radius:4px;
            font-size:14px;
            color:#fff;">
      </div>


      <!-- STEP 1 -->
<div id="transferStep1">
  <label>Select Transfer Type</label>
  <select id="transferType">
    <option value="">-- Select --</option>
    <option value="sepa">SEPA Transfer</option>
    <option value="wire">International Wire</option>
    <option value="internal">Internal Transfer</option>
    <option value="fx">FX Transfer</option>
  </select>
  <button onclick="nextTransferStep()">Continue</button>
</div>

<!-- STEP 2 -->
<div id="transferStep2" class="hidden">
  <label>Beneficiary Name</label><input type="text" id="beneficiaryName" placeholder="Full Name">
  <label>Bank Name</label><input type="text" id="bankName" placeholder="Bank Name">
  <label>IBAN / Account Number</label><input type="text" id="accountNumber" placeholder="IBAN or Account Number">
  <label>SWIFT / BIC</label><input type="text" id="swiftBic" placeholder="SWIFT / BIC">
  <label>Country</label><input type="text" id="country" placeholder="Country">
  <label>Amount</label><input type="text" id="transferAmount" placeholder="Amount">
  <label>Currency</label><input type="text" id="transferCurrency" placeholder="Currency">
  <label>Reference</label><input type="text" id="transferReference" placeholder="Reference">
  <button onclick="nextTransferStep()">Review Transfer</button>
</div>
        
      <!-- STEP 3: Review + COT -->
      <div id="transferStep3" class="hidden">
        <p><strong>COT Code Required</strong></p>
        <p>For security reasons, this transaction requires a COT code. Please contact Credit Suisse support to obtain your COT code.</p>
        <label>COT Code</label>
        <input type="text" id="cotCode" placeholder="Enter COT Code">
        <button onclick="finalizeTransfer()">Complete Transfer</button>
        <div id="cotError" class="muted" style="color:#b91c1c;margin-top:8px;display:none;">
          Invalid COT code. Please contact Credit Suisse support.
        </div>
      </div>
    </div>

    <!-- Transactions -->
    <div id="transactions" class="panel hidden">
      <h2>Recent transactions</h2>
      <table class="table" id="transactionTable">
        <tr><th>Date</th><th>Description</th><th>Amount</th></tr>
        <tr><td>25 Feb 2010</td><td>Revalidation Charges</td><td>+ GBP 5000.00</td></tr>
        <tr><td>19 Feb 2010</td><td>C.O.T charge</td><td>+ GBP 4245.39</td></tr>
      </table>
    </div>

    <!-- Investments -->
    <div id="investments" class="panel hidden">
      <h2>Investments</h2>
      <table class="table">
        <tr><th>Asset</th><th>Quantity</th><th>Value (CHF)</th><th>Performance</th></tr>
        <tr><td>Credit Suisse Fund</td><td>120</td><td>CHF 12,500.00</td><td>+3.2%</td></tr>
        <tr><td>Swiss Government Bond</td><td>50</td><td>CHF 5,000.00</td><td>+1.1%</td></tr>
        <tr><td>Nestlé Shares</td><td>200</td><td>CHF 22,000.00</td><td>-0.8%</td></tr>
      </table>
      <canvas id="investmentsChart" width="400" height="200"></canvas>
      <div id="investmentsLegend" style="margin-top:12px;font-size:13px;color:#374151;">
        <div><span style="display:inline-block;width:12px;height:12px;background:#003a8f;margin-right:6px;"></span> Credit Suisse Fund</div>
        <div><span style="display:inline-block;width:12px;height:12px;background:#4b5563;margin-right:6px;"></span> Swiss Government Bond</div>
        <div><span style="display:inline-block;width:12px;height:12px;background:#22c55e;margin-right:6px;"></span> Nestlé Shares</div>
      </div>
      <div id="investmentsSummary" style="margin-top:16px;padding:12px;background:#f0f2f5;border-radius:6px;font-size:14px;color:#1a1a1a;"></div>
    </div>

    <!-- Portfolio -->
    <div id="portfolio" class="panel hidden">
      <h2>Portfolio</h2>
      <p class="muted">Net worth summary</p>
      <canvas id="portfolioChart" width="300" height="200"></canvas>
    </div>

    <!-- Markets -->
    <div id="markets" class="panel hidden">
      <h2>Market Services</h2>
      <div style="background:#f0f2f5;border-radius:4px;padding:10px;font-size:13px;color:#1a1a1a;margin-bottom:16px;">
        <marquee>SMI +0.8% | Nestlé -0.5% | UBS +1.2% | Credit Suisse Fund +3.2%</marquee>
      </div>
      <div id="newsFeed" style="background:#fff;border-radius:6px;box-shadow:0 4px 12px rgba(0,0,0,0.08);padding:16px;font-size:14px;color:#1a1a1a;">
        <h3 style="margin-top:0;font-size:16px;color:#002a5c;">Latest Market News</h3>
        <ul id="newsList" style="list-style:none;padding:0;margin:0;"></ul>
      </div>
    </div>

    <!-- Settings -->
    <div id="settings" class="panel hidden">
      <h2>Settings</h2>
      <div class="settings-section">
        <button class="section-toggle">Account Details</button>
        <div class="section-content">
          <p><strong>Account Holder:</strong> Gerard Müller</p>
          <p><strong>Account Type:</strong> Private Banking</p>
          <p><strong>Account Number:</strong> 623852957</p>
          <p><strong>IBAN:</strong> CH93 0076 2011 6238 5295 7</p>
          <p><strong>SWIFT / BIC:</strong> CRESCHZZ80A</p>
          <p><strong>Bank:</strong> Credit Suisse AG</p>
          <p><strong>Branch:</strong> Zurich – Paradeplatz</p>
          <p><strong>Country:</strong> Switzerland</p>
          <p><strong>Relationship Manager:</strong> Anna Keller</p>
        </div>
      </div>
      <div class="settings-section">
        <button class="section-toggle">Change Password</button>
        <div class="section-content">
          <label>Current Password</label>
          <input type="password" id="oldPassword">
          <label>New Password</label>
          <input type="password" id="newPassword">
          <label>Confirm Password</label>
          <input type="password" id="confirmPassword">
          <button onclick="changePassword()">Change Password</button>
          <div id="passwordMsg" style="margin-top:8px; display:none;"></div>
        </div>
      </div>
      <div class="settings-section">
        <button class="section-toggle">Two-Factor Authentication</button>
        <div class="section-content">
          <label>
            <input type="checkbox" id="toggle2FA" onchange="toggle2FA()"> Enable 2FA
          </label>
        </div>
      </div>
      <div class="settings-section">
        <button class="section-toggle">Security Events</button>
        <div class="section-content">
          <ul id="securityEvents" style="padding-left:0;"></ul>
        </div>
      </div>
    </div>
  </div> <!-- end dashboard-content -->

  <!-- Footer always at the bottom -->
  <footer style="text-align:center;font-size:12px;color:#6b7280;margin:20px 0;">
    © 2026 Your Company. All rights reserved. | Privacy Policy | Legal Notice | Cookies
  </footer>
    </div>
        

<script>
  const encodedUser = btoa('demoUser');
  const STORAGE_KEY = 'bankState';

function loadState() {
  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved) return JSON.parse(saved);

  return {
    credentials: {
      encodedPass: btoa('demoPass'),
      twoFactorEnabled: true
    },
    security: {
      events: []
    }
  };
}

function saveState() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
}

let state = loadState();
let encodedPass = state.credentials.encodedPass;
let twoFactorEnabled = state.credentials.twoFactorEnabled;

function addSecurityEvent(type) {
  const event = {
    type,
    timestamp: new Date().toLocaleString(),
    device: navigator.userAgent.split(')')[0] + ')'
  };

  state.security.events.unshift(event);
  saveState();
  renderSecurityEvents();
}

function renderSecurityEvents() {
  const list = document.getElementById('securityEvents');
  if (!list) return;

  list.innerHTML = '';
  state.security.events.slice(0, 10).forEach(e => {
    const li = document.createElement('li');
    li.style.marginBottom = '8px';
    li.innerHTML = `<strong>${e.type}</strong><br><span class="muted">${e.timestamp} · ${e.device}</span>`;
    list.appendChild(li);
  });
}

  function showTempError(elementId, duration = 3000) {
  const el = document.getElementById(elementId);
  if (!el) return;
  el.style.display = 'block';
  setTimeout(() => {
    el.style.display = 'none';
  }, duration);
  }

  function login() {
  const u = document.getElementById('user').value;
  const p = document.getElementById('pass').value;

  if (btoa(u) === encodedUser && btoa(p) === encodedPass) {
    addSecurityEvent('LOGIN_SUCCESS');

    // Hide login error if it was shown
    document.getElementById('loginError').style.display = 'none';

    // Show fetching message
    const loadingMsg = document.getElementById('loginLoading');
    loadingMsg.classList.remove('hidden');

    // Rotate loading text (no animation, banking-style)
const loadingTexts = [
  'Fetching your account...',
  'Verifying your credentials...',
  'Preparing secure access...'
];

let textIndex = 0;
const loadingInterval = setInterval(() => {
  loadingMsg.textContent = loadingTexts[textIndex];
  textIndex = (textIndex + 1) % loadingTexts.length;
}, 3000);

    // Disable button to prevent double-click
    const loginBtn = document.querySelector('#loginPage button[type="submit"]');
    loginBtn.disabled = true;
    loginBtn.textContent = 'Logging in...';

    // Simulate account fetch
    setTimeout(() => {
      clearInterval(loadingInterval);
      
      // Hide login page
      document.getElementById('loginPage').classList.add('hidden');

      // Show OTP or dashboard
      if (twoFactorEnabled) {
        document.getElementById('secureAccess').classList.remove('hidden');
        showNewOTP();
      } else {
        document.getElementById('dashboard').classList.remove('hidden');
        document.getElementById('topbarUser').classList.remove('hidden');
        updateBalanceDisplay();
        showSection('overview');
      }

      // Reset UI
      loginBtn.disabled = false;
      loginBtn.textContent = 'Log in';
      loadingMsg.classList.add('hidden');
    }, 12000);

  } else {
    addSecurityEvent('LOGIN_FAILED');
    showTempError('loginError');
  }
  }

let accountBalance = 37571257.31;

function updateBalanceDisplay() {
  document.getElementById('balanceDisplay').textContent =
    'CHF ' + accountBalance.toLocaleString(undefined, {
      minimumFractionDigits: 2
    });
}

function changePassword() {
  const oldP = document.getElementById('oldPassword').value;
  const newP = document.getElementById('newPassword').value;
  const confirmP = document.getElementById('confirmPassword').value;
  const msg = document.getElementById('passwordMsg');

  msg.style.display = 'block';

  if (btoa(oldP) !== encodedPass) {
    msg.textContent = 'Current password incorrect.';
    msg.className = 'error';
    autoHide(msg);
    return;
  }

  if (newP.length < 6 || newP !== confirmP) {
    msg.textContent = 'Password validation failed.';
    msg.className = 'error';
    autoHide(msg);
    return;
  }

  encodedPass = btoa(newP);
  state.credentials.encodedPass = encodedPass;
  saveState();
  addSecurityEvent('PASSWORD_CHANGED');

  msg.textContent = 'Password successfully changed.';
  msg.className = 'success';
  autoHide(msg);

  // Clear inputs
  document.getElementById('oldPassword').value = '';
  document.getElementById('newPassword').value = '';
  document.getElementById('confirmPassword').value = '';
}

// Helper to auto-hide message after 3 seconds
function autoHide(element, timeout = 3000) {
  setTimeout(() => {
    element.style.display = 'none';
  }, timeout);
}
  
function toggle2FA() {
  const checkbox = document.getElementById('toggle2FA');
  twoFactorEnabled = checkbox.checked;
  state.credentials.twoFactorEnabled = twoFactorEnabled;
  saveState();

  // Always register security event
  addSecurityEvent(twoFactorEnabled ? '2FA_ENABLED' : '2FA_DISABLED');

  const msg = document.getElementById('twoFaMsg');
  msg.style.display = 'block';
  msg.textContent = twoFactorEnabled
    ? 'Two-factor authentication enabled.'
    : 'Two-factor authentication disabled.';
  msg.className = twoFactorEnabled ? 'success' : 'error';
}  
  
  function logout(){
    document.getElementById('dashboard').classList.add('hidden');
    document.getElementById('secureAccess').classList.add('hidden');
    document.getElementById('loginPage').classList.remove('hidden');
    document.getElementById('topbarUser').classList.add('hidden');
  }

  function showSection(id) {
  const panels = document.querySelectorAll('.panel');

  panels.forEach(p => {
    if (p.id !== id) {
      p.classList.remove('show');
      setTimeout(() => p.classList.add('hidden'), 350);
      p.classList.remove('flex');
    }
  });

  const panel = document.getElementById(id);
  if (panel) {
    panel.classList.remove('hidden');
    panel.classList.add('flex');
    setTimeout(() => panel.classList.add('show'), 20); // small delay for smooth animation
  }

  // Update sidebar active link
  document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));
  const activeLink = [...document.querySelectorAll('.sidebar a')]
    .find(a => a.getAttribute('onclick')?.includes(id));
  if (activeLink) activeLink.classList.add('active');

  // Optional: call chart/news functions
  if (id === 'portfolio') drawPortfolioChart();
  if (id === 'investments') drawInvestmentsChart();
  if (id === 'markets') refreshNewsFeed();
}

  function drawPortfolioChart() {
    const canvas = document.getElementById('portfolioChart');
    if (!canvas) return;
    const ctx = canvas.getContext('2d');
    const data = [30, 40, 20, 10];
    const colors = ['#003a8f', '#4b5563', '#22c55e', '#f59e0b'];
    let startAngle = 0;
    data.forEach((value, i) => {
      const sliceAngle = (value / 100) * 2 * Math.PI;
      ctx.beginPath();
      ctx.moveTo(canvas.width/2, canvas.height/2);
      ctx.arc(canvas.width/2, canvas.height/2, 90, startAngle, startAngle + sliceAngle);
      ctx.closePath();
      ctx.fillStyle = colors[i];
      ctx.fill();
      startAngle += sliceAngle;
    });
  }

  function drawInvestmentsChart() {
    const canvas = document.getElementById('investmentsChart');
    if (!canvas) return;
    const ctx = canvas.getContext('2d');
    const labels = ['Jan','Feb','Mar','Apr','May','Jun'];
    const datasets = [
      { name:'Credit Suisse Fund', values:[12000,12500,12300,12800,13000,12900], color:'#003a8f' },
      { name:'Swiss Government Bond', values:[5000,5050,5075,5100,5120,5150], color:'#4b5563' },
      { name:'Nestlé Shares', values:[22000,22100,21900,22200,22350,22200], color:'#22c55e' }
    ];

    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.beginPath();
    ctx.moveTo(40,10);
    ctx.lineTo(40,180);
    ctx.lineTo(380,180);
    ctx.strokeStyle='#374151';
    ctx.stroke();

    datasets.forEach(dataset=>{
      ctx.beginPath();
      ctx.strokeStyle = dataset.color;
      ctx.lineWidth = 2;
      dataset.values.forEach((val,i)=>{
        const x = 40 + i * 60;
        const y = 180 - ((val - 5000) / 20000) * 150;
        if(i===0) ctx.moveTo(x,y);
        else ctx.lineTo(x,y);
        ctx.fillStyle = dataset.color;
        ctx.beginPath();
        ctx.arc(x,y,3,0,2*Math.PI);
        ctx.fill();
      });
      ctx.stroke();
    });

    const totalValue = datasets.reduce((sum,d)=>sum + d.values[d.values.length-1],0);
    const overallPerf = ((totalValue - 39000) / 39000 * 100).toFixed(1);
    const summary = document.getElementById('investmentsSummary');
    if(summary){
      summary.innerHTML = `<strong>Total Portfolio Value:</strong> CHF ${totalValue.toLocaleString()}<br>
      <span style="color:${overallPerf >= 0 ? '#22c55e' : '#ef4444'};">
      ${overallPerf >= 0 ? '▲' : '▼'} Overall Performance: ${overallPerf}%</span>`;
    }
  }

  const headlines = [
    { title: "Swiss Market Index rises", summary: "Investors optimistic after strong Q4 earnings." },
    { title: "Nestlé reports steady growth", summary: "Food giant posts 2% revenue increase in latest quarter." },
    { title: "UBS expands wealth management", summary: "Bank announces new digital advisory services." },
    { title: "Global markets mixed", summary: "US tech stocks dip while European banks gain." },
    { title: "Swiss Franc strengthens", summary: "Investors flock to safe-haven CHF amid global uncertainty." },
    { title: "Roche reports new drug approval", summary: "Pharma giant receives FDA nod for oncology treatment." },
    { title: "Credit Suisse launches new ETF", summary: "Fund targets sustainable energy companies." },
    { title: "UBS expands into Asia-Pacific", summary: "Bank opens new offices in Singapore and Hong Kong." },
    { title: "Global tech earnings beat expectations", summary: "Strong performance drives Nasdaq higher." },
    { title: "Nestlé to acquire health startup", summary: "Move aims to boost nutritional products portfolio." },
    { title: "ECB keeps interest rates steady", summary: "Central bank signals cautious approach to inflation." },
    { title: "Gold prices rally", summary: "Investors seek refuge amid market volatility." },
    { title: "Bitcoin rebounds", summary: "Cryptocurrency rises above $45,000 after dip." },
    { title: "European energy stocks rise", summary: "Utility firms benefit from rising demand and supply constraints." },
    { title: "Swiss housing market steady", summary: "Low interest rates continue to support property prices." },
    { title: "Global trade growth slows", summary: "Analysts warn of potential supply chain disruptions." },
    { title: "Apple unveils new iPhone", summary: "Latest model features improved camera and battery life." },
    { title: "Tesla opens new Gigafactory", summary: "Facility aims to boost EV production in Europe." },
    { title: "Oil demand forecast revised up", summary: "International Energy Agency expects stronger recovery this year." },
    { title: "Credit Suisse Fund outperforms", summary: "Fund posts 3.2% growth amid volatile conditions." }
  ];
  let currentIndex = 0;

// Shuffle helper
function shuffleArray(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}

shuffleArray(headlines);

function refreshNewsFeed() {
  const list = document.getElementById('newsList');
  if (!list) return;

  list.innerHTML = "";

  for (let i = 0; i < 3; i++) {
    const item = headlines[(currentIndex + i) % headlines.length];
    const li = document.createElement('li');
    li.style.marginBottom = "10px";
    li.innerHTML = `<strong>${item.title}</strong><br><span class="muted">${item.summary}</span>`;
    list.appendChild(li);
  }

  currentIndex = (currentIndex + 1) % headlines.length;
}
  
  // Step navigation
let transferStep = 1;

function showTransferMessage(text, type='error', duration=3000) {
  const banner = document.getElementById('transferBanner');
  if (!banner) return;

  banner.textContent = text;
  banner.style.background = type === 'error' ? '#b91c1c' : '#065f46';
  banner.style.display = 'block';
  banner.style.opacity = 0;
  
  // Fade in
  setTimeout(() => banner.style.transition = 'opacity 0.35s ease', 10);
  setTimeout(() => banner.style.opacity = 1, 20);

  // Auto-hide
  clearTimeout(banner._timeout);
  banner._timeout = setTimeout(() => {
    banner.style.opacity = 0;
    setTimeout(() => banner.style.display = 'none', 350);
  }, duration);
}

function nextTransferStep() {
  if (transferStep === 1) {
    const type = document.getElementById('transferType').value;
    if (!type) {
      showTransferMessage("Please select a transfer type.");
      return;
    }

    const btn = document.querySelector('#transferStep1 button');
    btn.textContent = 'Processing...';
    btn.disabled = true;

    setTimeout(() => {
      document.getElementById('transferStep1').classList.add('hidden');
      document.getElementById('transferStep2').classList.remove('hidden');
      transferStep = 2;
      btn.textContent = 'Continue';
      btn.disabled = false;
    }, 1200); // fake delay
    
  } else if (transferStep === 2) {
    const requiredFields = [
      'beneficiaryName',
      'bankName',
      'accountNumber',
      'swiftBic',
      'country',
      'transferAmount',
      'transferCurrency'
    ];

    for (let id of requiredFields) {
      const el = document.getElementById(id);
      if (!el.value.trim()) {
        showTransferMessage("Please fill all required fields.");
        return;
      }
    }

    const amount = parseFloat(document.getElementById('transferAmount').value);
    if (isNaN(amount) || amount <= 0) {
      showTransferMessage("Enter a valid transfer amount.");
      return;
    }
    if (amount > accountBalance) {
      showTransferMessage("Insufficient balance.");
      return;
    }

    const btn = document.querySelector('#transferStep2 button');
    btn.textContent = 'Reviewing...';
    btn.disabled = true;

    setTimeout(() => {
      document.getElementById('transferStep2').classList.add('hidden');
      document.getElementById('transferStep3').classList.remove('hidden');
      transferStep = 3;
      btn.textContent = 'Review Transfer';
      btn.disabled = false;
    }, 1200);
  }
}

// Hardcoded COT code
const encodedCOT = btoa("COT-884219");

function finalizeTransfer() {
  const inputCOT = document.getElementById('cotCode').value;
  if (btoa(inputCOT) !== encodedCOT) {
    showTransferMessage("Invalid COT code.", "error");
    return;
  }

  const amountInput = document.getElementById('transferAmount');
  const beneficiaryInput = document.getElementById('beneficiaryName');
  const amount = parseFloat(amountInput.value);
  const beneficiary = beneficiaryInput.value.trim();

  if (!amount || amount <= 0 || !beneficiary) {
    showTransferMessage("Please fill all required fields.", "error");
    return;
  }
  if (amount > accountBalance) {
    showTransferMessage("Insufficient balance.", "error");
    return;
  }

  const btn = document.querySelector('#transferStep3 button');
  btn.textContent = 'Processing...';
  btn.disabled = true;

  setTimeout(() => {
    // Deduct balance & add transaction
    accountBalance -= amount;
    updateBalanceDisplay();
    const today = new Date().toLocaleDateString('en-GB', {
      day: '2-digit', month: 'short', year: 'numeric'
    });
    const tableBody = document.getElementById('transactionTable');
    const row = tableBody.insertRow(0);
    row.innerHTML = `
      <td>${today}</td>
      <td>Transfer to ${beneficiary}</td>
      <td>- CHF ${amount.toLocaleString(undefined, { minimumFractionDigits: 2 })}</td>
    `;

    // Show success message banner
    showTransferMessage("Transfer completed successfully.", "success", 2500);

    // After message disappears, reset transfer and go to overview
    setTimeout(() => {
      resetTransfer();
      showSection('overview');
      btn.textContent = 'Complete Transfer';
      btn.disabled = false;
    }, 2500);

  }, 1500); // fake latency
}
  function resetTransfer() {
  transferStep = 1;
  document.getElementById('transferStep1').classList.remove('hidden');
  document.getElementById('transferStep2').classList.add('hidden');
  document.getElementById('transferStep3').classList.add('hidden');

  // Clear all inputs/selects
  document.querySelectorAll('#payments input, #payments select')
    .forEach(el => el.value = '');

  // Hide message
  const box = document.getElementById('transferMessage');
  if (box) {
    box.classList.add('hidden');
    box.textContent = '';
  }
}
  document.addEventListener('DOMContentLoaded', () => {
  // Initialize 2FA toggle and security events
  document.getElementById('toggle2FA').checked = twoFactorEnabled;
  renderSecurityEvents();

  // Accordion / collapsible settings sections
  document.querySelectorAll('.section-toggle').forEach(btn => {
    btn.addEventListener('click', () => {
      const content = btn.nextElementSibling;

      // Close all other sections
      document.querySelectorAll('.section-content').forEach(c => {
        if (c !== content) c.classList.remove('open');
      });

      // Toggle clicked section
      content.classList.toggle('open');
    });
  });
});

  /* ================= SESSION + OTP CONTROL ================= */

// 1 minutes inactivity
const SESSION_TIMEOUT_MINUTES = 1;
let sessionTimer;
  

// Reset inactivity timer
function resetSessionTimer() {
  clearTimeout(sessionTimer);
  sessionTimer = setTimeout(() => {
    addSecurityEvent('SESSION_EXPIRED');
    performLogout();
  }, SESSION_TIMEOUT_MINUTES * 60 * 1000);
}

// Central logout (used by timeout AND manual logout)
function performLogout() {
  // Clear session persistence
  localStorage.removeItem('bankSessionActive');
  localStorage.removeItem('bankLastSection');

  addSecurityEvent('LOGOUT');

  // Clear sensitive fields
  ['user', 'pass', 'otp'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.value = '';
  });

  currentOTP = null;

  // Hide everything
  document.getElementById('dashboard')?.classList.add('hidden');
  document.getElementById('secureAccess')?.classList.add('hidden');
  document.getElementById('topbarUser')?.classList.add('hidden');
  document.getElementById('loginPage')?.classList.remove('hidden');

  // Full refresh (keeps localStorage state clean)
  setTimeout(() => location.reload(), 100);
                          }


// Activity listeners
['mousemove','keydown','click','touchstart'].forEach(evt =>
  document.addEventListener(evt, resetSessionTimer)
);

// Start timer on load
document.addEventListener('DOMContentLoaded', resetSessionTimer);

// Override existing logout()
function logout() {
  performLogout();
} 
  
/* ================= OTP PAGE LOGIC (FIXED) ================= */

let currentOTP = null;
let otpInterval = null;
let otpSeconds = 60;

/* Generate 6-digit OTP */
function generateOTP() {
  return Math.floor(100000 + Math.random() * 900000).toString();
}

/* Render OTP + countdown */
function renderOTP() {
  document.getElementById('otpDisplay').textContent =
    `Your verification code: ${currentOTP}`;
  document.getElementById('otpCountdown').style.display = 'block';
  document.getElementById('otpTimer').textContent = otpSeconds;
  document.getElementById('phoneError').style.display = 'none';
}

/* Start countdown */
function startCountdown() {
  clearInterval(otpInterval);
  otpSeconds = 60;
  renderOTP();

  otpInterval = setInterval(() => {
    otpSeconds--;
    document.getElementById('otpTimer').textContent = otpSeconds;

    if (otpSeconds <= 0) {
      expireOTP();
    }
  }, 1000);
}

/* Expire OTP */
function expireOTP() {
  clearInterval(otpInterval);
  currentOTP = null;

  document.getElementById('otpDisplay').textContent =
    'Your verification code has expired.';
  document.getElementById('otpCountdown').style.display = 'none';
}

/* Generate + show OTP (page load & resend ONLY) */
function showNewOTP() {
  currentOTP = generateOTP();
  startCountdown();
}

/* Verify OTP */
function verifyOTP() {
  const input = document.getElementById('otp').value.trim();

  if (!currentOTP || input !== currentOTP) {
    showTempError('phoneError');
    return;
  }

  localStorage.setItem(SESSION_KEY, 'true');
localStorage.setItem(LAST_SECTION_KEY, 'overview');

  clearInterval(otpInterval);
  currentOTP = null;

  addSecurityEvent('OTP_VERIFIED');

  document.getElementById('secureAccess').classList.add('hidden');
  document.getElementById('dashboard').classList.remove('hidden');
  document.getElementById('topbarUser').classList.remove('hidden');

  updateBalanceDisplay();
  showSection('overview');
}

/* Resend OTP */
function resendOTP() {
  showNewOTP();
}

/* Auto-generate OTP when OTP page becomes visible */
document.addEventListener('DOMContentLoaded', () => {
  const observer = new MutationObserver(() => {
    const otpPage = document.getElementById('secureAccess');
    if (!otpPage.classList.contains('hidden') && !currentOTP) {
      showNewOTP();
    }
  });

  observer.observe(document.getElementById('secureAccess'), {
    attributes: true,
    attributeFilter: ['class']
  });
});

/* ================= SESSION PERSISTENCE (REFRESH SAFE) ================= */

const SESSION_KEY = 'bankSessionActive';
const LAST_SECTION_KEY = 'bankLastSection';

/* Restore session on page refresh */
document.addEventListener('DOMContentLoaded', () => {
  const sessionActive = localStorage.getItem(SESSION_KEY) === 'true';

  if (sessionActive) {
    document.getElementById('loginPage').classList.add('hidden');
    document.getElementById('secureAccess').classList.add('hidden');
    document.getElementById('dashboard').classList.remove('hidden');
    document.getElementById('topbarUser').classList.remove('hidden');

    updateBalanceDisplay();

    const lastSection =
      localStorage.getItem(LAST_SECTION_KEY) || 'overview';

    showSection(lastSection);
  }
});

/* Save last active dashboard section */
const originalShowSection = showSection;
showSection = function (id) {
  localStorage.setItem(LAST_SECTION_KEY, id);
  originalShowSection(id);
};

document.addEventListener('DOMContentLoaded', () => {
  // Only clear if we're on the login page
  if (!document.getElementById('loginPage')?.classList.contains('hidden')) {
    
    // Clear all input fields
    document.querySelectorAll('input').forEach(input => input.value = '');

    // Clear all textareas
    document.querySelectorAll('textarea').forEach(area => area.value = '');

    // Reset all selects (dropdowns) to first option
    document.querySelectorAll('select').forEach(select => select.selectedIndex = 0);

    // Uncheck any checkboxes or radio buttons
    document.querySelectorAll('input[type="checkbox"], input[type="radio"]').forEach(box => box.checked = false);
  }
});
</script>
</body>
</html>
